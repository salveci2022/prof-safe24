<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>PROF-SAFE 24 - Professor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        :root { --bg: #020617; }
        * { box-sizing:border-box; }
        body {
            margin:0;
            font-family: Arial, sans-serif;
            background: radial-gradient(circle at top left, #0f172a 0, #020617 55%, #000 100%);
            color:#e5e7eb;
            min-height:100vh;
            display:flex;
            align-items:center;
            justify-content:center;
        }
        .shell {
            width:100%;
            max-width:540px;
            background:rgba(2,8,23,0.96);
            border-radius:20px;
            border:1px solid rgba(56,189,248,0.35);
            box-shadow:0 22px 60px rgba(0,0,0,0.9);
            padding:16px 16px 18px;
        }
        .shell-inner { position:relative; z-index:1; }

        .logo-banner {
            display:flex;
            justify-content:flex-start;
            margin-bottom:12px;
        }
        .logo-banner img {
            max-width:140px;
            height:auto;
            filter: drop-shadow(0 0 20px rgba(34,211,238,0.6));
        }

        header {
            display:flex;
            justify-content:space-between;
            margin-bottom:14px;
        }
        .brand { display:flex; align-items:center; gap:8px; }
        .brand-icon {
            width:36px; height:36px;
            border-radius:14px;
            background:radial-gradient(circle at 30% 0, #facc15, #e11d48 45%, #0f172a 100%);
            color:#fff; font-size:11px; display:flex; justify-content:center; align-items:center;
        }

        .pill-online {
            padding:4px 10px;
            border-radius:999px;
            font-size:12px;
            border:1px solid #22c55e;
            color:#bbf7d0;
            background:rgba(6,95,70,0.6);
        }
        .clock { text-align:right; font-size:12px; color:#facc15; margin-top:4px; }

        main {
            background:rgba(15,23,42,0.95);
            padding:14px;
            border-radius:16px;
            border:1px solid rgba(148,163,184,0.4);
        }

        label { display:block; margin-bottom:4px; font-size:12px; }
        input, textarea {
            width:100%; padding:8px; margin-bottom:10px;
            border-radius:10px; border:1px solid rgba(148,163,184,0.9);
            background:rgba(15,23,42,0.96); color:#e5e7eb;
        }
        textarea { min-height:70px; resize:vertical; }

        .btn-alert {
            width:100%; padding:10px; margin-top:8px;
            border-radius:999px;
            background:linear-gradient(135deg,#f97316,#b91c1c);
            border:none; color:#fff; font-size:15px;
            font-weight:bold; cursor:pointer;
        }

        .actions-row {
            display:flex; gap:8px; margin-top:10px;
        }
        .btn-secondary {
            flex:1; padding:8px; font-size:12px;
            border-radius:999px;
            border:1px solid rgba(148,163,184,0.8);
            background:rgba(15,23,42,0.96);
            color:#e5e7eb; cursor:pointer;
        }

        .feedback {
            margin-top:8px; font-size:12px;
            color:#bbf7d0; display:none;
        }
    </style>
</head>

<body>
<div class="shell">

    <div class="logo-banner">
        <img src="{{ url_for('static', filename='logo_prof_safe24.png') }}">
    </div>

    <div class="shell-inner">

        <header>
            <div class="brand">
                <div class="brand-icon">PS24</div>
                <div>
                    <div style="font-size:16px; font-weight:600;">PROF-SAFE 24</div>
                    <div style="font-size:11px; color:#9ca3af;">Prote√ß√£o inteligente</div>
                </div>
            </div>
            <div>
                <div class="pill-online">‚óè Conectado</div>
                <div class="clock" id="clockProf"></div>
            </div>
        </header>

        <main>
            <form id="alertForm">
                <label>Seu nome (opcional)</label>
                <input id="teacher" placeholder="Ex.: Prof. Ana">

                <label>Sala / Local *</label>
                <input id="room" placeholder="Ex.: 5¬∫ A" required>

                <label>Descri√ß√£o *</label>
                <textarea id="description" placeholder="Ex.: aluno passando mal" required></textarea>

                <button type="submit" class="btn-alert" id="btnAlert">üö® ENVIAR ALERTA</button>

                <div class="actions-row">
                    <button type="button" class="btn-secondary" id="btnReiniciar">‚ü≥ Reiniciar</button>
                    <button type="button" class="btn-secondary" id="btnLimpar">üßπ Limpar</button>
                    <button type="button" class="btn-secondary" id="btnSair">‚èª Sair</button>
                </div>
            </form>

            <div class="feedback" id="feedbackMsg">Alerta enviado com sucesso.</div>
        </main>
    </div>
</div>

<script>
/* Rel√≥gio */
function updateClock(){
    document.getElementById("clockProf").textContent =
        new Date().toLocaleTimeString("pt-BR",{hour12:false});
}
setInterval(updateClock,1000); updateClock();

/* Formul√°rio */
const form = document.getElementById("alertForm");
const feedback = document.getElementById("feedbackMsg");
const btnAlert = document.getElementById("btnAlert");

/* Evitar m√∫ltiplos envios */
let sending = false;

form.addEventListener("submit", async (e)=>{
    e.preventDefault();

    if(sending) return;
    sending = true;

    const teacher = teacher.value;
    const room = room.value;
    const description = description.value;

    btnAlert.disabled = true;
    btnAlert.innerHTML = "Enviando...";

    try {
        const res = await fetch("/api/alert",{
            method:"POST",
            headers:{ "Content-Type":"application/json" },
            body:JSON.stringify({teacher, room, description})
        });

        const data = await res.json();

        if(data.ok){
            feedback.style.display="block";
            form.reset();
            setTimeout(()=>feedback.style.display="none",3000);
        }
    } catch(err){
        alert("Erro ao enviar.");
    }

    btnAlert.disabled = false;
    btnAlert.innerHTML = "üö® ENVIAR ALERTA";
    sending = false;
});

/* Bot√µes extras */
document.getElementById("btnLimpar").onclick = ()=> form.reset();
document.getElementById("btnReiniciar").onclick = ()=> location.reload();
document.getElementById("btnSair").onclick = ()=> location.href="/";
</script>

</body>
</html>
